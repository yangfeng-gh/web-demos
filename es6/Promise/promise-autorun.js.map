{"version":3,"sources":["promise-autorun.es6"],"names":[],"mappings":";;8EAGiB,I;;wGAAA,I;;;;;;;;2CAAb,E;;;;;;;;;;;;;AAEJ,QAAI,WAAW,SAAX,QAAW,CAAU,QAAV,EAAmB;AAC9B,eAAO,sBAAY,UAAU,OAAV,EAAmB,MAAnB,EAA0B;AACzC,eAAG,QAAH,CAAY,QAAZ,EAAsB,UAAS,KAAT,EAAgB,IAAhB,EAAqB;AACvC,oBAAI,KAAJ,EAAW,OAAO,OAAO,KAAP,CAAP;AACX,wBAAQ,IAAR;AACH,aAHD;AAIH,SALM,CAAP;AAMH,KAPD;;AASA,QAAI,iCAAM,SAAN,GAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+BACS,SAAS,WAAT,CADT;;AAAA;AACF,0BADE;AAAA;AAAA,+BAES,SAAS,YAAT,CAFT;;AAAA;AAEF,0BAFE;;AAGN,gCAAQ,GAAR,CAAY,GAAG,QAAH,EAAZ;AACA,gCAAQ,GAAR,CAAY,GAAG,QAAH,EAAZ;;AAJM;AAAA;AAAA;AAAA;AAAA;AAAA,WAAN,GAAM;AAAA,KAAN,CAAJ;;AAOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,aAAS,GAAT,CAAa,GAAb,EAAiB;AACb,YAAI,IAAI,KAAR;;AAEA,iBAAS,IAAT,CAAc,IAAd,EAAmB;AACf,gBAAI,SAAS,EAAE,IAAF,CAAO,IAAP,CAAb;AACA,gBAAI,OAAO,IAAX,EAAiB,OAAO,OAAO,KAAd;AACjB,mBAAO,KAAP,CAAa,IAAb,CAAkB,UAAS,IAAT,EAAc;AAC5B,qBAAK,IAAL;AACH,aAFD;AAGH;;AAED;AACH;;AAED,QAAI,GAAJ","file":"promise-autorun.js","sourcesContent":["/**\r\n * 基于Promise对象的自动执行\r\n */\r\nvar fs = require('fs');\r\n\r\nvar readFile = function (fileName){\r\n    return new Promise(function (resolve, reject){\r\n        fs.readFile(fileName, function(error, data){\r\n            if (error) return reject(error);\r\n            resolve(data);\r\n        });\r\n    });\r\n};\r\n\r\nvar gen = function* (){\r\n    var f1 = yield readFile('user.json');\r\n    var f2 = yield readFile('goods.json');\r\n    console.log(f1.toString());\r\n    console.log(f2.toString());\r\n};\r\n\r\n// var g = gen();\r\n//\r\n// g.next().value.then(function(data){\r\n//     g.next(data).value.then(function(data){\r\n//         g.next(data);\r\n//     });\r\n// });\r\n// 手动执行其实就是用then方法，层层添加回调函数。理解了这一点，就可以写出一个自动执行器。\r\n\r\nfunction run(gen){\r\n    var g = gen();\r\n\r\n    function next(data){\r\n        var result = g.next(data);\r\n        if (result.done) return result.value;\r\n        result.value.then(function(data){\r\n            next(data);\r\n        });\r\n    }\r\n\r\n    next();\r\n}\r\n\r\nrun(gen);"]}